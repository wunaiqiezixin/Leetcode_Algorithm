# 15. 三数之和
[力扣题目链接](https://leetcode.cn/problems/3sum/description/)

---
### 大体思路
- 先对数组nums从小到大排序
- 用一重for循环确定第一个数下标i
- 在for循环内部，用left,right指针确定第二、三个数
### 难点：去重
- 对第一个数去重，一定是和它的前一个数比较，若相同，则continue
- 对第二三个数去重，当确定了left、right符合要求后，对其去重
---
#### 排序
- 归并排序
```C
//归并排序
//merge()函数：将数组a中的有序部分start~mid、mid+1~end合并，得到排序的数组a
void merge(int* a, int start, int mid, int end, int* tmp)
{
	int p = 0, p1 = start, p2 = mid + 1;
	while (p1 <= mid && p2 <= end)
	{
		if (a[p1] <= a[p2]) tmp[p++] = a[p1++];
		else tmp[p++] = a[p2++];
	}
	while (p1 <= mid) tmp[p++] = a[p1++];
	while (p2 <= end) tmp[p++] = a[p2++];
	for (int i = 0; i < end - start + 1; i++) a[start + i] = tmp[i];
}
//mergeSort()函数：将数组a中的start~end排序
void mergeSort(int* a, int start, int end, int* tmp)
{
	if (start < end)//递归实现，用if,这里不是while
	{
		int mid = start + (end - start) / 2;
		//分治
		mergeSort(a, start, mid, tmp);
		mergeSort(a, mid + 1, end, tmp);
		merge(a, start, mid, end, tmp);
	}
	//若start == end，则只有一个元素，自然有序
	return;
}
```
```C
//排序数组nums
    int* tmp = (int*)malloc(sizeof(int) * numsSize);
    mergeSort(nums, 0, numsSize - 1, tmp);
    free(tmp);
```
#### 分配足够的空间
```C
    *returnSize = 0;
    *returnColumnSizes = (int*)malloc(sizeof(int) * numsSize *numsSize);
    int** ret = (int**)malloc(sizeof(int*) * numsSize *numsSize);
```
#### 找出三个不重复的数
```C
    int i, left, right;
    for (i = 0; i < numsSize - 2; i++)
    {
        //剪枝:若第一个最小的数大于0，则不可能和为0
        if (nums[i] > 0) break;
        //对第一个数去重，和它的前一个数比较
        if (i != 0 && nums[i] == nums[i - 1]) continue;
        //找第二、第三个数
        left = i + 1, right = numsSize - 1;
        while (left < right)
        {
            int sum = nums[i] + nums[left] + nums[right];
            if (sum < 0) left++;
            else if (sum > 0) right--;
            else 
            {
                
                //找到了满足条件的三个数，再次去重
                while (left < right && nums[left] == nums[left+1]) left++;
                while (left < right && nums[right] == nums[right-1]) right--;
                //记录这三个数
                int* ans = (int*)malloc(sizeof(int) * 3);
                ans[0] = nums[i];
                ans[1] = nums[left];
                ans[2] = nums[right];
                //加入到ret
                ret[*returnSize] = ans;
                (*returnColumnSizes)[*returnSize] = 3;
                (*returnSize)++;
                //移动left、right，寻找其他解
                left++;
                right--;
            }
        } 
    }
```
### 完整代码
### ***C:***
```C
int** threeSum(int* nums, int numsSize, int* returnSize, int** returnColumnSizes) {
    //排序数组nums
    int* tmp = (int*)malloc(sizeof(int) * numsSize);
    mergeSort(nums, 0, numsSize - 1, tmp);
    free(tmp);
    //分配空间
    *returnSize = 0;
    *returnColumnSizes = (int*)malloc(sizeof(int) * numsSize *numsSize);
    int** ret = (int**)malloc(sizeof(int*) * numsSize *numsSize);
    //先用一重循环，确定一个数
    int i, left, right;
    for (i = 0; i < numsSize - 2; i++)
    {
        //剪枝
        if (nums[i] > 0) break;
        //对第一个数去重
        if (i != 0 && nums[i] == nums[i - 1]) continue;
        //找第二、第三个数
        left = i + 1, right = numsSize - 1;
        while (left < right)
        {
            int sum = nums[i] + nums[left] + nums[right];
            if (sum < 0) left++;
            else if (sum > 0) right--;
            else 
            {
                
                //找到了满足条件的三个数，再次去重
                while (left < right && nums[left] == nums[left+1]) left++;
                while (left < right && nums[right] == nums[right-1]) right--;
                //记录这三个数
                int* ans = (int*)malloc(sizeof(int) * 3);
                ans[0] = nums[i];
                ans[1] = nums[left];
                ans[2] = nums[right];
                //加入到ret
                ret[*returnSize] = ans;
                (*returnColumnSizes)[*returnSize] = 3;
                (*returnSize)++;
                //移动left、right，寻找其他解
                left++;
                right--;
            }
        } 
    }
    return ret;
}
```
